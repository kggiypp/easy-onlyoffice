<?xml version="1.0" encoding="utf-8"?>
<configuration status="WARN">
    
    <properties>
        <property name="log_pattern">%d{yyyy-MM-dd HH:mm:ss.SSS} |-%-5level [%thread] %c [%L] -| %msg%n</property>
        <property name="file_pattern">$${date:yyyy-MM}/%d{yyyy-MM-dd}-%i.log.gz</property>
        <property name="log_size">256MB</property>
        <property name="delete_age">15d</property>
    </properties>
    
    <appenders>
        <Console name="console" target="system_out">
            <PatternLayout pattern="${log_pattern}" />
        </Console>
        
        <RollingFile name="appLog" fileName="logs/app.log" filePattern="logs/app-${file_pattern}">
            <PatternLayout pattern="${log_pattern}"/>
            <Policies>
                <TimeBasedTriggeringPolicy />
                <SizeBasedTriggeringPolicy size="${log_size}" />
            </Policies>
            <DefaultRolloverStrategy>
                <Delete basePath="logs/" maxDepth="2">
                    <IfFileName glob="app-**"/>
                    <IfLastModified age="${delete_age}" />
                </Delete>
            </DefaultRolloverStrategy>
        </RollingFile>
    </appenders>

    <loggers>
        <root level="info">
			<AppenderRef ref="console" />
            <AppenderRef ref="appLog" />
		</root>
    </loggers>

</configuration>